(function(e){"use strict";const b=e.defineComponent({name:"Countdown",props:{timestamp:{type:[Number,String,Date],required:!0},hintText:{type:String,default:"Day|Hour|Min|Sec"}},setup(t){const l="base-theme-countdown",i=e.ref(0),a=e.ref([]),r=o=>{let[d,h,s,n]=[0,0,0,0];o>0&&(d=Math.floor(o/60/60/24),h=Math.floor(o/60/60%24),s=Math.floor(o/60%60),n=Math.floor(o%60));const m=_=>String(_).padStart(2,"0");return[d,h,s,n].map(m)},u=()=>{const o=new Date(t.timestamp).getTime(),d=Date.now();i.value=Math.max(0,Math.floor((o-d)/1e3)),a.value=t.hintText.split("|").map(h=>h.trim())},c=e.computed(()=>r(i.value));return u(),e.onMounted(()=>{const o=setInterval(()=>{i.value<=0?clearInterval(o):i.value--},1e3);e.onUnmounted(()=>{clearInterval(o)})}),()=>{if(i.value<=0)return null;const o=c.value,d=a.value;return e.createVNode("div",{class:`${l}`},[e.createVNode("div",{class:`${l}__container`},[o.map((h,s)=>e.createVNode("div",{key:s,class:`${l}-item`},[e.createVNode("span",{class:`${l}-item__num`},[h]),e.createVNode("span",{class:`${l}-item__text`},[d[s]])]))])])}}}),f=Object.freeze(Object.defineProperty({__proto__:null,createCountdownApp:(t,l)=>{if(!t)return console.error("需要提供有效的 DOM 元素"),null;const i=e.createApp(b,l),a=i.mount(t);return{unmount:()=>i.unmount(),instance:a}}},Symbol.toStringTag,{value:"Module"})),g=e.defineComponent({name:"Timeline",props:{items:{type:Array,default:()=>[]},allTags:{type:String,default:"All"},results:{type:String,default:"@count results"}},setup(t){const l=e.ref(),i=e.ref(),a=e.ref(!0),r=e.computed(()=>{const s=[...new Set(t.items?.map(n=>n.date))].filter(Boolean);return l.value=s?.[0],s}),u=e.computed(()=>{const s=[...new Set(t.items?.reduce((n,m)=>n.concat(m.tags),[]))].filter(Boolean);return s?.unshift(t.allTags),i.value=s?.[0],s}),c=s=>{l.value=s},o=()=>{setTimeout(()=>{a.value=!0},300)},d=e.computed(()=>t.items?.filter(s=>i.value===t.allTags?s.date===l.value:s.date===l.value&&s.tags.includes(i.value))),h=e.computed(()=>t.results.replace("@count",`<span class="base-theme-timeline__results-num">${d.value?.length}</span>`));return()=>{const s=()=>e.createVNode("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",fill:"none",version:"1.1",width:"18",height:"18",viewBox:"0 0 18 18"},[e.createVNode("defs",null,[e.createVNode("clipPath",{id:"master_svg0_745_72570/556_024318"},[e.createVNode("rect",{x:"0",y:"0",width:"18",height:"18",rx:"0"},null)])]),e.createVNode("g",{"clip-path":"url(#master_svg0_745_72570/556_024318)"},[e.createVNode("g",null,[e.createVNode("path",{d:"M9,12L4.5,7.5L13.5,7.5L9,12Z",fill:"#666666","fill-opacity":"1"},null)])])]);return e.createVNode("div",{class:"base-theme-timeline"},[e.createVNode("div",{class:"base-theme-timeline__tools"},[u.value?.length?e.createVNode("div",{class:["base-theme-timeline__dropdown",{"base-theme-timeline__dropdown-menu--hidden":a.value}]},[e.createVNode("input",{type:"text",class:"base-theme-timeline__control",onFocus:()=>a.value=!1,onBlur:o},null),i.value,e.createVNode("div",{class:"base-theme-timeline__dropdown-icon"},[e.createVNode(s,null,null)]),e.createVNode("div",{class:"base-theme-timeline__dropdown-menu"},[u.value.map((n,m)=>e.createVNode("div",{key:m,class:["base-theme-timeline__dropdown-menu__item",{"base-theme-timeline__dropdown-menu__item--active":n===i.value}],onClick:()=>i.value=n},[n]))])]):null,e.createVNode("div",{class:"base-theme-timeline__results",innerHTML:h.value},null)]),r.value?.length?e.createVNode("div",{class:"base-theme-timeline__dates"},[r.value.map((n,m)=>e.createVNode("div",{key:m,class:["base-theme-timeline__dates-item",{"base-theme-timeline__dates-item--active":n===l.value}],onClick:()=>c(n)},[n]))]):null,d.value.map((n,m)=>e.createVNode("div",{key:m,class:"base-theme-timeline-item"},[n?.startTime&&n?.endTime?e.createVNode("div",{class:"base-theme-timeline-item__time"},[`${n.startTime}-${n.endTime}`]):n?.hintText?e.createVNode("div",{class:"base-theme-timeline-item__hint-text"},[n.hintText]):null,e.createVNode("div",{class:"base-theme-timeline-item__primary"},[e.createVNode("div",{class:"base-theme-timeline-item__tail"},null),e.createVNode("div",{class:"base-theme-timeline-item__node"},null),n?.title?e.createVNode("div",{class:"base-theme-timeline-item__title"},[n.title]):null,n?.subTitle?e.createVNode("div",{class:"base-theme-timeline-item__subtitle"},[n.subTitle]):null,n?.description?e.createVNode("div",{class:"base-theme-timeline-item__description",innerHTML:n.description},null):null,n?.tags?.length?e.createVNode("div",{class:"base-theme-timeline-item__tags"},[n.tags.map((_,S)=>e.createVNode("div",{key:S,class:"base-theme-timeline-item__tags-item"},[_]))]):null])]))])}}}),N=e.ref([]),p=t=>{N.value=t},V=(t,l)=>{if(!t)return console.error("需要提供有效的 DOM 元素"),null;const i=e.createApp(g,l),a=i.mount(t);return{unmount:()=>i.unmount(),instance:a}};(function(t,l){t.behaviors.timeline={attach:function(i,a){const r=a.timeline;p(r)}}})(Drupal,drupalSettings);const w=Object.freeze(Object.defineProperty({__proto__:null,createTimelineApp:V,getTimeline:p},Symbol.toStringTag,{value:"Module"})),y=e.defineComponent({name:"TextWithEmbed",props:{loadJS:String,runJS:String,embedHtml:String,richtext:String,buttons:{type:Array,default:()=>[]},settings:{type:Object,default:()=>({})}},setup(t){const l=e.computed(()=>{const a=["base-theme-text-with-embedding"];for(let[r,u]of Object.entries(t.settings))r!=="buttonStyle"&&(r=kebabCase(r),a.push(`${a[0]}--${r}-${u}`));return a.join(" ")}),i=a=>new Promise((r,u)=>{let c=document.querySelector(`script[src='${a}']`);c||(c=document.createElement("script"),c.type="text/javascript",c.src=a,document.body.appendChild(c)),c.addEventListener("load",()=>r(c)),c.addEventListener("error",o=>u(o))});return e.onMounted(async()=>{try{t.loadJS&&await i(t.loadJS),t.runJS&&new Function(t.runJS)()}catch(a){console.error("脚本执行失败:",a)}}),()=>e.createVNode("div",{class:l.value},[e.createVNode("div",{class:"base-theme-text-with-embedding__grid"},[e.createVNode("div",{class:"base-theme-text-with-embedding__embed"},[e.createVNode("div",{class:"el-ratio",innerHTML:t.embedHtml},null)]),e.createVNode("div",{class:"base-theme-text-with-embedding__text"},[e.createVNode(e.resolveComponent("Richtext"),{simpleTable:!0,html:t.richtext},null),t.buttons?.length>0&&e.createVNode("div",{class:"base-theme-links base-theme-links--direction-row",style:{justifyContent:"inherit"}},[t.buttons.map((a,r)=>e.createVNode(e.resolveComponent("CallToActionBtn"),e.mergeProps({key:r,btnStyle:t.settings?.buttonStyle},a),null))])])])])}}),T={countdown:f,timeline:w,textWithEmbed:Object.freeze(Object.defineProperty({__proto__:null,createTextWithEmbedApp:(t,l)=>{if(!t)return console.error("需要提供有效的 DOM 元素"),null;const i=e.createApp(y,l),a=i.mount(t);return{unmount:()=>i.unmount(),instance:a}}},Symbol.toStringTag,{value:"Module"}))};typeof window<"u"&&(window.baseThemeHooks=T),setTimeout(()=>{window.dispatchEvent(new Event("baseThemeHooks:load"))},300)})(Vue);
//# sourceMappingURL=hooks.iife.js.map
