{"version":3,"file":"hooks.iife.js","sources":["../../hooks/countdown/countdown.jsx","../../hooks/countdown/countdown-bridge.js","../../hooks/timeline/timeline.jsx","../../hooks/timeline/timeline-behavior.js","../../hooks/index.js"],"sourcesContent":["import { defineComponent, ref, computed, onMounted, onUnmounted } from 'vue'\n\nexport const Countdown = defineComponent({\n  name: 'Countdown',\n  \n  props: {\n    timestamp: {\n      type: [Number, String, Date],\n      required: true\n    },\n    hintText: {\n      type: String,\n      default: 'Day|Hour|Min|Sec'\n    }\n  },\n  \n  setup(props) {\n    const rootClassName = 'base-theme-countdown'\n    const countdown = ref(0)\n    const timeTexts = ref([])\n\n    const getDiff = (countdown) => {\n      let [d, h, m, s] = [0, 0, 0, 0]\n      if (countdown > 0) {\n        d = Math.floor(countdown / 60 / 60 / 24)\n        h = Math.floor((countdown / 60 / 60) % 24)\n        m = Math.floor((countdown / 60) % 60)\n        s = Math.floor(countdown % 60)\n      }\n      const padZero = num => String(num).padStart(2, '0')\n      return [d, h, m, s].map(padZero)\n    }\n\n    const init = () => {\n      const endTime = new Date(props.timestamp).getTime()\n      const startTime = Date.now()\n      countdown.value = Math.max(0, Math.floor((endTime - startTime) / 1000))\n      \n      timeTexts.value = props.hintText.split('|').map(str => str.trim())\n    }\n\n    const currentDiff = computed(() => getDiff(countdown.value))\n\n    init()\n\n    onMounted(() => {\n      const timer = setInterval(() => {\n        if (countdown.value <= 0) {\n          clearInterval(timer)\n        } else {\n          countdown.value--\n        }\n      }, 1000)\n      \n      onUnmounted(() => {\n        clearInterval(timer)\n      })\n    })\n\n    // JSX 渲染函数\n    return () => {\n      if (countdown.value <= 0) {\n        return null\n      }\n\n      const diff = currentDiff.value\n      const timeUnits = timeTexts.value\n\n      return (\n        <div class={`${rootClassName}`}>\n          <div class={`${rootClassName}__container`}>\n            {diff.map((time, index) => (\n              <div key={index} class={`${rootClassName}-item`}>\n                <span class={`${rootClassName}-item__num`}>{time}</span>\n                <span class={`${rootClassName}-item__text`}>{timeUnits[index]}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      )\n    }\n  }\n})\n","import { createApp } from 'vue'\nimport { Countdown } from './countdown.jsx'\n\n// 导出供 Twig 使用的函数\nexport const createCountdownApp = (element, options) => {\n  if (!element) {\n    console.error('需要提供有效的 DOM 元素')\n    return null\n  }\n  \n  const app = createApp(Countdown, options)\n  const vm = app.mount(element)\n  \n  return {\n    unmount: () => app.unmount(),\n    instance: vm\n  }\n}\n","import { defineComponent, ref, computed } from 'vue'\n\nconst timelines = []\nexport const initTimeline = (timeline) => {\n  timelines = timeline\n}\n\nexport default defineComponent({\n  name: 'ContentTimeline',\n  \n  setup() {\n    const allTags = 'All'\n    const results = '@count results'\n\n    const dateActive = ref()\n    const tagActive = ref()\n    const tagMenuHidden = ref(true)\n\n    // 计算日期选项\n    const dates = computed(() => {\n      const options = [...new Set(timelines?.map(item => item.date))]?.filter(Boolean)\n      dateActive.value = options?.[0]\n      return options\n    })\n\n    // 计算标签选项\n    const tags = computed(() => {\n      const options = [...new Set(timelines?.reduce((acc, item) => acc.concat(item.tags), []))]?.filter(Boolean)\n      options?.unshift(allTags)\n      tagActive.value = options?.[0]\n      return options\n    })\n\n    // 选择日期\n    const selectDate = (date) => {\n      dateActive.value = date\n    }\n\n    // 隐藏标签菜单\n    const hiddenMenu = () => {\n      setTimeout(() => {\n        tagMenuHidden.value = true\n      }, 300)\n    }\n\n    // 计算显示的timeline项目\n    const displayTimelines = computed(() => {\n      return timelines?.filter(item => {\n        if (tagActive.value === allTags) {\n          return item.date === dateActive.value\n        }\n        return item.date === dateActive.value && item.tags.includes(tagActive.value)\n      })\n    })\n\n    // 计算结果消息\n    const resultsMsg = computed(\n      () => results.replace(\n        '@count', \n        `<span class=\"el-content-timeline__results-num\">${displayTimelines.value?.length}</span>`\n      )\n    )\n\n    return {\n      dateActive,\n      dates,\n      selectDate,\n      tagActive,\n      tags,\n      tagMenuHidden,\n      hiddenMenu,\n      displayTimelines,\n      resultsMsg\n    }\n  },\n  \n  render() {\n    const SvgIcon = () => (\n      <svg \n        xmlns=\"http://www.w3.org/2000/svg\" \n        xmlns:xlink=\"http://www.w3.org/1999/xlink\" \n        fill=\"none\" \n        version=\"1.1\" \n        width=\"18\" \n        height=\"18\" \n        viewBox=\"0 0 18 18\"\n      >\n        <defs>\n          <clipPath id=\"master_svg0_745_72570/556_024318\">\n            <rect x=\"0\" y=\"0\" width=\"18\" height=\"18\" rx=\"0\"/>\n          </clipPath>\n        </defs>\n        <g clip-path=\"url(#master_svg0_745_72570/556_024318)\">\n          <g>\n            <path d=\"M9,12L4.5,7.5L13.5,7.5L9,12Z\" fill=\"#666666\" fill-opacity=\"1\"/>\n          </g>\n        </g>\n      </svg>\n    )\n\n    return (\n      <div class=\"el-content-timeline\">\n        {/* 工具区域 */}\n        <div class=\"el-content-timeline__tools\">\n          {this.tags?.length ? (\n            <div class={[\n              'el-content-timeline__dropdown',\n              {\n                'el-content-timeline__dropdown-menu--hidden': this.tagMenuHidden\n              }\n            ]}>\n              <input \n                type=\"text\" \n                class=\"el-content-timeline__control\" \n                onFocus={() => this.tagMenuHidden = false}\n                onBlur={this.hiddenMenu}\n              />\n              {this.tagActive}\n              <div class=\"el-content-timeline__dropdown-icon\">\n                <SvgIcon />\n              </div>\n              <div class=\"el-content-timeline__dropdown-menu\">\n                {this.tags.map((tag, index) => (\n                  <div \n                    key={index}\n                    class={[\n                      'el-content-timeline__dropdown-menu__item',\n                      {\n                        'el-content-timeline__dropdown-menu__item--active': tag === this.tagActive\n                      }\n                    ]}\n                    onClick={() => this.tagActive = tag}\n                  >\n                    {tag}\n                  </div>\n                ))}\n              </div>\n            </div>\n          ) : null}\n          <div \n            class=\"el-content-timeline__results\" \n            innerHTML={this.resultsMsg}\n          />\n        </div>\n\n        {/* 日期选择器 */}\n        {this.dates?.length ? (\n          <div class=\"el-content-timeline__dates\">\n            {this.dates.map((date, index) => (\n              <div \n                key={index}\n                class={[\n                  'el-content-timeline__dates-item',\n                  {\n                    'el-content-timeline__dates-item--active': date === this.dateActive\n                  }\n                ]}\n                onClick={() => this.selectDate(date)}\n              >\n                {date}\n              </div>\n            ))}\n          </div>\n        ) : null}\n\n        {/* Timeline 项目列表 */}\n        {this.displayTimelines.map((item, index) => (\n          <div key={index} class=\"el-content-timeline-item\">\n            {/* 时间显示 */}\n            {item?.startTime && item?.endTime ? (\n              <div class=\"el-content-timeline-item__time\">\n                {`${item.startTime}-${item.endTime}`}\n              </div>\n            ) : item?.hintText ? (\n              <div class=\"el-content-timeline-item__hint-text\">\n                {item.hintText}\n              </div>\n            ) : null}\n\n            {/* 主要内容 */}\n            <div class=\"el-content-timeline-item__primary\">\n              <div class=\"el-content-timeline-item__tail\"></div>\n              <div class=\"el-content-timeline-item__node\"></div>\n              \n              {item?.title ? (\n                <div class=\"el-content-timeline-item__title\">\n                  {item.title}\n                </div>\n              ) : null}\n              \n              {item?.subTitle ? (\n                <div class=\"el-content-timeline-item__subtitle\">\n                  {item.subTitle}\n                </div>\n              ) : null}\n              \n              {item?.description ? (\n                <div \n                  class=\"el-content-timeline-item__description\"\n                  innerHTML={item.description}\n                />\n              ) : null}\n              \n              {item?.tags?.length ? (\n                <div class=\"el-content-timeline-item__tags\">\n                  {item.tags.map((tag, tagIndex) => (\n                    <div key={tagIndex} class=\"el-content-timeline-item__tags-item\">\n                      {tag}\n                    </div>\n                  ))}\n                </div>\n              ) : null}\n            </div>\n          </div>\n        ))}\n      </div>\n    )\n  }\n})\n","import { initTimeline } from './timeline'\n\n(function(Drupal, drupalSettings) {\n  'use strict'\n\n  Drupal.behaviors.timeline = {\n    attach: function(context, settings) {\n      const timelines = settings.timeline\n      // console.log('behaviors timelines', timelines)\n      initTimeline(timelines)\n    }\n  }\n\n})(Drupal, drupalSettings)","import * as countdown from './countdown'\nimport * as timeline from './timeline'\n\nconst baseThemeHooks = {\n  countdown,\n  timeline\n}\n\nif (typeof window !== 'undefined') {\n  window.baseThemeHooks = baseThemeHooks\n}\n\nwindow.dispatchEvent(new Event('baseThemeHooks:load'))\n"],"names":["Countdown","defineComponent","name","props","timestamp","type","Number","String","Date","required","hintText","default","setup","rootClassName","countdown","ref","timeTexts","getDiff","d","h","m","s","Math","floor","padZero","num","padStart","map","init","endTime","getTime","startTime","now","value","max","split","str","trim","currentDiff","computed","onMounted","timer","setInterval","clearInterval","onUnmounted","diff","timeUnits","_createVNode","time","index","element","options","app","createApp","vm","initTimeline","timeline","Drupal","drupalSettings","context","settings","baseThemeHooks"],"mappings":"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"}